@page "/"
@rendermode InteractiveServer

<PageTitle>Home</PageTitle>

<div class="home-container">
    <div class="welcome-section">
        <h1>@WelcomeMessage</h1>
        <p class="welcome-subtitle">@GetTimeBasedGreeting()</p>
        <p class="welcome-text">Welcome to your new app built with Blazor Server!</p>
    </div>

    <div class="contributors-section">
        <h2>Project Contributors</h2>
        
        @if (contributors == null || contributors.Count == 0)
        {
            <p class="text-muted">Loading contributors...</p>
        }
        else
        {
            <div class="table-responsive">
                <table class="table table-striped table-hover">
                    <thead class="table-dark">
                        <tr>
                            <th>ID</th>
                            <th>Name</th>
                            <th>Role</th>
                            <th>Email</th>
                            <th>Join Date</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var contributor in contributors)
                        {
                            <tr>
                                <td>@contributor.Id</td>
                                <td>
                                    <strong>@contributor.Name</strong>
                                </td>
                                <td>
                                    <span class="badge bg-@GetRoleBadgeColor(contributor.Role)">
                                        @contributor.Role
                                    </span>
                                </td>
                                <td>
                                    <a href="mailto:@contributor.Email">@contributor.Email</a>
                                </td>
                                <td>
                                    <small>@contributor.JoinDate.ToString("dd/MM/yyyy")</small>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>

            <div class="stats-section mt-4">
                <div class="row">
                    <div class="col-md-4">
                        <div class="stat-card">
                            <h5>Total Contributors</h5>
                            <p class="stat-number">@contributors.Count</p>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="stat-card">
                            <h5>Developers</h5>
                            <p class="stat-number">@contributors.Count(c => c.Role == "Developer")</p>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="stat-card">
                            <h5>Designers</h5>
                            <p class="stat-number">@contributors.Count(c => c.Role == "Designer")</p>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>
</div>

@code {
    private List<Contributor> contributors = new();
    private string WelcomeMessage = "Hello, world!";

    protected override async Task OnInitializedAsync()
    {
        // Simular carga de datos con delay
        await Task.Delay(500);
        
        // Cargar contribuidores
        LoadContributors();
        
        // Actualizar mensaje de bienvenida con la hora
        UpdateWelcomeMessage();
    }

    private void LoadContributors()
    {
        contributors = new List<Contributor>
        {
            new Contributor 
            { 
                Id = 1, 
                Name = "A Escobar", 
                Role = "Developer", 
                Email = "a.escobar@company.com", 
                JoinDate = new DateTime(2024, 01, 15) 
            },
            new Contributor 
            { 
                Id = 2, 
                Name = "María García", 
                Role = "Designer", 
                Email = "m.garcia@company.com", 
                JoinDate = new DateTime(2024, 02, 01) 
            },
            new Contributor 
            { 
                Id = 3, 
                Name = "Carlos López", 
                Role = "Developer", 
                Email = "c.lopez@company.com", 
                JoinDate = new DateTime(2024, 02, 15) 
            },
            new Contributor 
            { 
                Id = 4, 
                Name = "Ana Rodríguez", 
                Role = "Developer", 
                Email = "a.rodriguez@company.com", 
                JoinDate = new DateTime(2024, 03, 01) 
            },
            new Contributor 
            { 
                Id = 5, 
                Name = "Juan Martínez", 
                Role = "QA", 
                Email = "j.martinez@company.com", 
                JoinDate = new DateTime(2024, 03, 15) 
            },
            new Contributor 
            { 
                Id = 6, 
                Name = "Sofia Herrera", 
                Role = "Designer", 
                Email = "s.herrera@company.com", 
                JoinDate = new DateTime(2024, 04, 01) 
            }
        };
    }

    private void UpdateWelcomeMessage()
    {
        var hour = DateTime.Now.Hour;
        
        if (hour >= 5 && hour < 12)
        {
            WelcomeMessage = "¡Buenos días! 🌅";
        }
        else if (hour >= 12 && hour < 17)
        {
            WelcomeMessage = "¡Buenas tardes! ☀️";
        }
        else if (hour >= 17 && hour < 21)
        {
            WelcomeMessage = "¡Buenas noches! 🌆";
        }
        else
        {
            WelcomeMessage = "¡Hola! Bienvenido 🌙";
        }
    }

    private string GetTimeBasedGreeting()
    {
        var hour = DateTime.Now.Hour;
        
        return hour switch
        {
            >= 5 and < 12 => "¡Qué tengas un excelente día!",
            >= 12 and < 17 => "¡Espero que estés teniendo un gran día!",
            >= 17 and < 21 => "¡Descansa un poco después de tu trabajo!",
            _ => "¡Qué descanses bien!"
        };
    }

    private string GetRoleBadgeColor(string role)
    {
        return role switch
        {
            "Developer" => "primary",
            "Designer" => "success",
            "QA" => "warning",
            "Manager" => "danger",
            _ => "secondary"
        };
    }

    public class Contributor
    {
        public int Id { get; set; }
        public string Name { get; set; } = string.Empty;
        public string Role { get; set; } = string.Empty;
        public string Email { get; set; } = string.Empty;
        public DateTime JoinDate { get; set; }
    }
}
